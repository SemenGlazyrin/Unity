# АНАЛИЗ ДАННЫХ И ИСКУССТВЕННЫЙ ИНТЕЛЛЕКТ [in GameDev]
Отчет по лабораторной работе #4 выполнил(а):
- Глазырин Семён Дмитриевич
- РИ220933
Отметка о выполнении заданий (заполняется студентом):

| Задание | Выполнение | Баллы |
| ------ | ------ | ------ |
| Задание 1 | * | 60 |
| Задание 2 | * | 20 |
| Задание 3 | * | 20 |

знак "*" - задание выполнено; знак "#" - задание не выполнено;

Работу проверили:
- к.т.н., доцент Денисов Д.В.
- к.э.н., доцент Панов М.А.
- ст. преп., Фадеев В.О.

## Цель работы
Реализовать перцептрон в Unity
Сделать выводы о корректности его работы

## Задание 1
### в проекте Unity реализовать перцептрон, который умеет производить вычисления:
### OR | дать комментарии о корректности работы
### AND | дать комментарии о корректности работы
### NAND | дать комментарии о корректности работы
### XOR | дать комментарии о корректности работы

Ход работы:
- Создаем новый проект в Unity
- Добавляем пустой объект на сцену и добавляем к нему файл Perceptron.cs
- Запускаем проект на разных данных, используя разное число эпох обучения и делаем выводы

OR:
После проведения тестов, выяснилось, что для обучения перцептрона с безошибочными ответами достаточно 5-6 эпох
1 эпоха:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/1/or.png)

5 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/5/or.png)

8 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/8/or.png)

AND:
После проведения тестов, выяснилось, что для обучения перцептрона с безошибочными ответами достаточно 7-8 эпох
1 эпоха:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/1/and.png)

5 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/5/and.png)

8 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/8/and.png)

NAND:
После проведения тестов, выяснилось, что для обучения перцептрона с безошибочными ответами достаточно 7-8 эпох
1 эпоха:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/1/nand.png)

5 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/5/nand.png)

8 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/8/nand.png)

XOR:
Т.к. перцептрон работает только с линейными функциями, а ХОR - не линейная функция, то это означет, что сколько бы эпох мы не ставили, он не будет выводит правильные результаты тестов
1 эпоха:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/1/xor.png)

5 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/5/xor.png)

8 эпох:
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/8/xor.png)

## Задание 2
### Построить графики зависимости количества эпох от ошибки обучения. Указать от чего зависит необходимое количество эпох обучения.
Количество необходимых эпох обучения зависит от весов и смещения. Также важное значение придается ошибке обучения, т.е. необходимо подобрать оптимальное число эпох для минимизации ошибки, что позволит перцептрону завершить обучение успешно.
- ![Image alt](https://github.com/SemenGlazyrin/Unity/blob/a7072130d5135d8de1a0321ff4d8a75fab564130/screens/lab4/tabl.png)

Вывод:
- При решении операции XOR среднее увеличивается с каждой эпохой, достигает максимума и остаётся неизменной.
- Для операции AND среднее снижается с каждой эпохой и к приблизительно 10-й эпохе достигает нуля. Для успешного обучения перцептрону достаточно провести обучение на 10 и более эпохах, чтобы уверенно давать правильные ответы. Если на графике видно, что ошибка обучения достигла нуля на 10-й эпохе, то можно закончить обучение, иначе риск переобучения.
- При решении операции NAND среднее сокращается по мере эпох и к около 9-10-й эпохе также достигает нулевого значения. Этого количества обучения достаточно для уверенных и правильных результатов работы перцептрона. Если видно, что на 9-й эпохе ошибка обучения равна нулю, можно завершить обучение, иначе существует риск переобучения.
- При операции OR среднее уменьшается с каждой эпохой и к примерно 4-5-й эпохе достигает нуля. В данном случае 10 эпох слишком много, и перцептрон просто запоминает тренировочные данные, что ведёт к переобучению. Оптимальное количество эпох для операции OR, на мой взгляд, составляет от 4 до 6 в зависимости от результатов обучения перцептрона.

## Задание 3
### Построить визуальную модель работы перцептрона на сцене Unity.
Тесты для OR, AND, NAND в зависимости от операции проходят одинаково и без ошибок: https://youtu.be/2ylhZjHVPXE

Несколько тестов XOR: https://youtu.be/4i6PEK9KIEo

Как мы видим, если перцептрон успешно проходит тест, то нижний куб становятся зелёным цветом. Если же тест провален, то кубик становятся красным.

Вот такой код я написал для кубиков

```cs
using UnityEngine;

public class And : MonoBehaviour
{
    public private Material matRed;
    public Material matGreen;
    public Perceptron per;
    public double i1;
    public double i2;

    private void OnCollisionEnter(Collision collision)
    {
        if (collision.transform.tag == "cube")
        {
            if (per.Out(i1, i2) == 1)
                GetComponent<Renderer>().material = matGreen;
            else 
                GetComponent<Renderer>().material = matRed;
        }
            
    }
}
```

Для удобства я сделал публичные переменные со значениями, которые будут передаваться в перцептрон, а также материалы и экземпляр класса Perceptron

Также вот такой метод дописал в классе Perceptron

```cs
public double Out(double i1, double i2) =>
	CalcOutput(i1, i2);
```

## Выводы
Изучил и визуализировал персептрон в Unity
Проверил корректности его работы на примере функций OR, AND, NAND, XOR